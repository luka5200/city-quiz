<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>城市灵魂匹配测试</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 800px;
            width: 100%;
            padding: 40px;
            position: relative;
            overflow: hidden;
        }
        
        .container::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg);
            animation: shine 3s infinite;
        }
        
        @keyframes shine {
            0% { transform: translateX(-100%) rotate(45deg); }
            100% { transform: translateX(100%) rotate(45deg); }
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            margin-bottom: 30px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }
        
        .question-card {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .question-card.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .question-number {
            color: #667eea;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .question-text {
            font-size: 24px;
            font-weight: 700;
            color: #333;
            margin-bottom: 30px;
            line-height: 1.4;
        }
        
        .options {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .option {
            padding: 18px 24px;
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            color: #495057;
            display: flex;
            align-items: center;
        }
        
        .option:hover {
            background: #e9ecef;
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
        }
        
        .option.selected {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: transparent;
            color: white;
            transform: scale(1.02);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }
        
        .option-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: rgba(102, 126, 234, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            font-weight: 600;
            font-size: 14px;
            color: #667eea;
        }
        
        .option.selected .option-icon {
            background: rgba(255, 255, 255, 0.3);
            color: white;
        }
        
        .result-card {
            display: none;
            text-align: center;
            animation: fadeIn 0.5s ease;
        }
        
        .result-card.active {
            display: block;
        }
        
        .city-name {
            font-size: 48px;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 20px;
            animation: scaleIn 0.5s ease;
        }
        
        @keyframes scaleIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .match-score {
            font-size: 72px;
            font-weight: 900;
            color: #667eea;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            animation: countUp 1s ease;
        }
        
        @keyframes countUp {
            from { opacity: 0; transform: scale(0.5); }
            to { opacity: 1; transform: scale(1); }
        }
        
        .match-label {
            font-size: 18px;
            color: #666;
            margin-bottom: 30px;
        }
        
        .city-tags {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .tag {
            padding: 8px 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }
        
        .city-description {
            font-size: 16px;
            color: #666;
            line-height: 1.8;
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
        }
        
        .radar-chart-container {
            margin: 30px 0;
            display: flex;
            justify-content: center;
        }
        
        #radarChart {
            max-width: 100%;
            height: auto;
        }
        
        .similar-cities {
            margin-top: 40px;
        }
        
        .similar-cities h3 {
            font-size: 20px;
            font-weight: 700;
            color: #333;
            margin-bottom: 20px;
        }
        
        .city-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .city-item {
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
            text-align: center;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .city-item:hover {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
        
        .city-item-name {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 8px;
        }
        
        .city-item-score {
            font-size: 24px;
            font-weight: 900;
            color: #667eea;
        }
        
        .city-item:hover .city-item-score {
            color: white;
        }
        
        .restart-btn {
            margin-top: 40px;
            padding: 16px 48px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 30px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
        
        .restart-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(102, 126, 234, 0.4);
        }
        
        .restart-btn:active {
            transform: translateY(0);
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            .question-text {
                font-size: 20px;
            }
            
            .city-name {
                font-size: 36px;
            }
            
            .match-score {
                font-size: 56px;
            }
            
            .city-list {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 15px;
            }
            
            .question-text {
                font-size: 18px;
            }
            
            .city-name {
                font-size: 28px;
            }
            
            .match-score {
                font-size: 48px;
            }
            
            .option {
                padding: 14px 16px;
                font-size: 14px;
            }
            
            .city-list {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        
        <div id="quizContainer">
            <!-- 问题会动态生成 -->
        </div>
        
        <div class="result-card" id="resultCard">
            <div class="city-name" id="cityName"></div>
            <div class="match-score" id="matchScore"></div>
            <div class="match-label">灵魂匹配度</div>
            
            <div class="city-tags" id="cityTags"></div>
            
            <div class="city-description" id="cityDescription"></div>
            
            <div class="radar-chart-container">
                <canvas id="radarChart"></canvas>
            </div>
            
            <div class="similar-cities">
                <h3>同类城市推荐</h3>
                <div class="city-list" id="cityList"></div>
            </div>
            
            <button class="restart-btn" onclick="restartQuiz()">重新测试</button>
        </div>
    </div>

    <script>
        // 城市数据库 - 32个城市
        const cities = [
            {
                name: "北京",
                tags: ["政治中心", "文化古都", "科技创新"],
                description: "北方的帝王之城，千年古都与现代科技的完美融合。你既有历史的厚重感，又勇于拥抱未来，在传统与创新之间找到完美平衡。",
                dimensions: { money: 85, relax: 45, open: 75, food: 70, environment: 50, stability: 90 },
                region: "north"
            },
            {
                name: "上海",
                tags: ["国际大都市", "金融中心", "时尚潮流"],
                description: "东方巴黎，中西文化的交汇点。你追求精致生活，善于吸收多元文化，在快节奏中保持优雅格调。",
                dimensions: { money: 95, relax: 35, open: 90, food: 85, environment: 60, stability: 75 },
                region: "east"
            },
            {
                name: "广州",
                tags: ["商都", "美食之都", "务实进取"],
                description: "千年商都，务实与开放的代名词。你善于商业运作，注重实际利益，同时包容四方来客。",
                dimensions: { money: 80, relax: 60, open: 85, food: 90, environment: 65, stability: 70 },
                region: "south"
            },
            {
                name: "深圳",
                tags: ["创新之都", "青年之城", "科技先锋"],
                description: "中国硅谷，梦想家的乐园。你充满激情，敢于冒险，永远在追求下一个突破。",
                dimensions: { money: 88, relax: 40, open: 95, food: 65, environment: 70, stability: 55 },
                region: "south"
            },
            {
                name: "成都",
                tags: ["天府之国", "慢生活", "美食天堂"],
                description: "安逸之都，生活艺术的典范。你懂得享受生活，在美食与悠闲中找到人生真谛。",
                dimensions: { money: 55, relax: 95, open: 70, food: 95, environment: 80, stability: 85 },
                region: "southwest"
            },
            {
                name: "杭州",
                tags: ["人间天堂", "互联网之城", "诗意栖居"],
                description: "江南明珠，古典与现代的完美融合。你既有诗情画意，又紧跟科技潮流。",
                dimensions: { money: 75, relax: 70, open: 80, food: 80, environment: 90, stability: 80 },
                region: "east"
            },
            {
                name: "重庆",
                tags: ["山城", "火锅之都", "江湖气"],
                description: "魔幻山城，热情奔放的江湖儿女。你性格直爽，热情如火，在起伏中保持坚韧。",
                dimensions: { money: 60, relax: 65, open: 75, food: 90, environment: 55, stability: 70 },
                region: "southwest"
            },
            {
                name: "西安",
                tags: ["古都", "历史之城", "文化底蕴"],
                description: "十三朝古都，中华文明的摇篮。你尊重历史，注重文化传承，在古老中发现新的价值。",
                dimensions: { money: 50, relax: 60, open: 60, food: 80, environment: 60, stability: 85 },
                region: "northwest"
            },
            {
                name: "武汉",
                tags: ["九省通衢", "英雄之城", "江湖豪情"],
                description: "英雄之城，敢为人先的开拓者。你性格豪爽，勇于担当，在困难面前从不退缩。",
                dimensions: { money: 65, relax: 55, open: 70, food: 85, environment: 60, stability: 75 },
                region: "central"
            },
            {
                name: "南京",
                tags: ["六朝古都", "文化名城", "书香门第"],
                description: "金陵帝王州，人文荟萃之地。你温文尔雅，注重教育与文化，历史底蕴深厚。",
                dimensions: { money: 60, relax: 65, open: 65, food: 75, environment: 75, stability: 85 },
                region: "east"
            },
            {
                name: "苏州",
                tags: ["人间天堂", "园林之城", "精致典雅"],
                description: "东方威尼斯，精致生活的代表。你追求完美，注重细节，在传统中展现现代品味。",
                dimensions: { money: 70, relax: 75, open: 70, food: 85, environment: 85, stability: 80 },
                region: "east"
            },
            {
                name: "天津",
                tags: ["渤海明珠", "幽默城市", "港口之都"],
                description: "相声之乡，幽默乐观的港口城市。你风趣幽默，待人真诚，在平凡中发现乐趣。",
                dimensions: { money: 55, relax: 70, open: 65, food: 75, environment: 65, stability: 80 },
                region: "north"
            },
            {
                name: "青岛",
                tags: ["海滨城市", "啤酒之都", "欧式风情"],
                description: "东方瑞士，浪漫的海滨都市。你热爱自然，享受生活，中西合璧的风格独特。",
                dimensions: { money: 65, relax: 75, open: 70, food: 80, environment: 85, stability: 75 },
                region: "east"
            },
            {
                name: "长沙",
                tags: ["星城", "娱乐之都", "火辣热情"],
                description: "娱乐之城，热情奔放的中部明珠。你性格开朗，善于社交，在热闹中保持活力。",
                dimensions: { money: 60, relax: 70, open: 75, food: 90, environment: 70, stability: 65 },
                region: "central"
            },
            {
                name: "厦门",
                tags: ["海上花园", "文艺之都", "宜居城市"],
                description: "鹭岛厦门，文艺青年的梦想之地。你追求浪漫，热爱艺术，在慢节奏中享受生活。",
                dimensions: { money: 55, relax: 85, open: 70, food: 80, environment: 90, stability: 80 },
                region: "east"
            },
            {
                name: "昆明",
                tags: ["春城", "鲜花之都", "多彩民族"],
                description: "四季如春，多元文化的交汇点。你性格温和，包容开放，在多样性中保持和谐。",
                dimensions: { money: 50, relax: 90, open: 75, food: 75, environment: 95, stability: 75 },
                region: "southwest"
            },
            {
                name: "大连",
                tags: ["浪漫之都", "海滨城市", "北方明珠"],
                description: "北方香港，浪漫的海滨都市。你追求品质，注重形象，在优雅中展现自信。",
                dimensions: { money: 60, relax: 75, open: 70, food: 75, environment: 85, stability: 80 },
                region: "northeast"
            },
            {
                name: "沈阳",
                tags: ["工业重镇", "历史名城", "豪爽大气"],
                description: "盛京沈阳，工业文明的见证者。你性格豪爽，重情重义，在变迁中保持坚韧。",
                dimensions: { money: 50, relax: 55, open: 60, food: 70, environment: 60, stability: 75 },
                region: "northeast"
            },
            {
                name: "哈尔滨",
                tags: ["冰城", "音乐之都", "欧陆风情"],
                description: "东方莫斯科，冰雪童话的世界。你浪漫多情，热爱艺术，在寒冷中保持温暖。",
                dimensions: { money: 45, relax: 60, open: 65, food: 70, environment: 70, stability: 70 },
                region: "northeast"
            },
            {
                name: "郑州",
                tags: ["中原腹地", "交通枢纽", "历史名城"],
                description: "中原之心，历史与现代的交汇。你务实进取，注重实效，在发展中保持平衡。",
                dimensions: { money: 55, relax: 55, open: 60, food: 75, environment: 60, stability: 75 },
                region: "central"
            },
            {
                name: "济南",
                tags: ["泉城", "历史文化名城", "宜居城市"],
                description: "泉城济南，泉水叮咚的诗意之地。你性格温和，注重生活品质，在传统中发现美。",
                dimensions: { money: 50, relax: 65, open: 60, food: 75, environment: 75, stability: 80 },
                region: "north"
            },
            {
                name: "福州",
                tags: ["榕城", "海滨城市", "历史文化名城"],
                description: "有福之州，三坊七巷的历史印记。你珍视传统，注重家庭，在变迁中保持初心。",
                dimensions: { money: 55, relax: 70, open: 65, food: 80, environment: 80, stability: 85 },
                region: "east"
            },
            {
                name: "合肥",
                tags: ["科教之城", "创新之都", "中部崛起"],
                description: "科技新城，创新驱动的典范。你注重学习，追求进步，在发展中不断突破。",
                dimensions: { money: 60, relax: 60, open: 70, food: 70, environment: 70, stability: 75 },
                region: "east"
            },
            {
                name: "贵阳",
                tags: ["林城", "避暑之都", "大数据之都"],
                description: "爽爽的贵阳，大数据的新高地。你乐于接受新事物，注重环保，在发展中保持清新。",
                dimensions: { money: 50, relax: 75, open: 70, food: 75, environment: 85, stability: 70 },
                region: "southwest"
            },
            {
                name: "南宁",
                tags: ["绿城", "东盟门户", "壮乡风情"],
                description: "绿城南宁，东盟合作的桥头堡。你开放包容，善于交流，在多元文化中找到定位。",
                dimensions: { money: 50, relax: 70, open: 75, food: 80, environment: 80, stability: 75 },
                region: "south"
            },
            {
                name: "太原",
                tags: ["龙城", "历史文化名城", "工业城市"],
                description: "龙城太原，晋商文化的传承者。你重情重义，注重诚信，在发展中保持传统。",
                dimensions: { money: 50, relax: 50, open: 55, food: 70, environment: 55, stability: 70 },
                region: "north"
            },
            {
                name: "石家庄",
                tags: ["国际庄", "交通枢纽", "新兴城市"],
                description: "国际庄，北方的新兴都市。你善于学习，勇于创新，在发展中展现活力。",
                dimensions: { money: 55, relax: 55, open: 60, food: 65, environment: 60, stability: 70 },
                region: "north"
            },
            {
                name: "南昌",
                tags: ["英雄城", "红色之都", "江南水乡"],
                description: "英雄城南昌，革命精神的传承地。你性格坚韧，勇于奋斗，在困难中保持信念。",
                dimensions: { money: 55, relax: 60, open: 65, food: 75, environment: 65, stability: 70 },
                region: "east"
            },
            {
                name: "兰州",
                tags: ["黄河之都", "西北门户", "丝路重镇"],
                description: "黄河明珠，丝绸之路的见证者。你性格坚韧，包容开放，在艰苦中保持乐观。",
                dimensions: { money: 50, relax: 55, open: 60, food: 70, environment: 60, stability: 70 },
                region: "northwest"
            },
            {
                name: "乌鲁木齐",
                tags: ["西域明珠", "亚欧中心", "多元文化"],
                description: "亚欧之心，多元文化的交汇点。你包容开放，善于学习，在多样性中发现价值。",
                dimensions: { money: 55, relax: 60, open: 65, food: 75, environment: 65, stability: 65 },
                region: "northwest"
            },
            {
                name: "银川",
                tags: ["塞上江南", "西夏古都", "宜居城市"],
                description: "塞上明珠，黄河文化的传承者。你注重环保，热爱自然，在发展中保持平衡。",
                dimensions: { money: 50, relax: 65, open: 60, food: 70, environment: 75, stability: 70 },
                region: "northwest"
            },
            {
                name: "海口",
                tags: ["椰城", "海滨度假", "自贸港"],
                description: "椰风海韵，自贸港的新机遇。你追求自由，热爱自然，在开放中寻找机遇。",
                dimensions: { money: 55, relax: 85, open: 75, food: 80, environment: 90, stability: 70 },
                region: "south"
            }
        ];

        // 15道测试题目
        const questions = [
            {
                question: "周末的理想安排是什么？",
                options: [
                    "加班赚钱，搞事业",
                    "宅在家里追剧打游戏",
                    "和三五好友聚餐聊天",
                    "探索城市的网红打卡点"
                ]
            },
            {
                question: "面对工作压力，你会？",
                options: [
                    "迎难而上，加班加点",
                    "适度放松，劳逸结合",
                    "寻找团队支持",
                    "暂时逃避，调整心态"
                ]
            },
            {
                question: "你最看重生活的哪个方面？",
                options: [
                    "事业成功，财富自由",
                    "悠闲自在，享受生活",
                    "社交广泛，人脉资源",
                    "新鲜体验，探索未知"
                ]
            },
            {
                question: "对于新事物，你的态度是？",
                options: [
                    "谨慎观察，不轻易尝试",
                    "乐于接受，主动学习",
                    "保持开放，适度尝试",
                    "热烈拥抱，第一时间体验"
                ]
            },
            {
                question: "理想的工作环境是？",
                options: [
                    "竞争激烈，成长快速",
                    "和谐稳定，待遇优厚",
                    "团队协作，氛围友好",
                    "灵活自由，激发创意"
                ]
            },
            {
                question: "对于美食，你更倾向于？",
                options: [
                    "特色小吃，地道风味",
                    "家常菜，温暖有爱",
                    "精致料理，品质生活",
                    "各种菜系，都想尝试"
                ]
            },
            {
                question: "选择居住地时，你最看重？",
                options: [
                    "发展机会，职业前景",
                    "生活成本，性价比",
                    "自然环境，空气质量",
                    "医疗教育，基础设施"
                ]
            },
            {
                question: "面对社交活动，你会？",
                options: [
                    "选择性参加，注重质量",
                    "积极参加，拓展人脉",
                    "偶尔参加，维护关系",
                    "热衷参加，享受热闹"
                ]
            },
            {
                question: "理想的生活方式是？",
                options: [
                    "快节奏，高效率",
                    "慢生活，有品质",
                    "平衡发展，工作生活两不误",
                    "随心所欲，自由自在"
                ]
            },
            {
                question: "对于传统文化，你的态度是？",
                options: [
                    "尊重并学习传承",
                    "有兴趣但不会深入研究",
                    "偶尔关注，保持敬畏",
                    "更关注现代文化"
                ]
            },
            {
                question: "面对变化，你会？",
                options: [
                    "主动适应，快速调整",
                    "观察后慢慢适应",
                    "寻求建议，平稳过渡",
                    "拥抱变化，享受挑战"
                ]
            },
            {
                question: "理想的城市节奏是？",
                options: [
                    "快节奏，充满活力",
                    "中等节奏，张弛有度",
                    "慢节奏，悠闲自在",
                    "多样化，可以自由选择"
                ]
            },
            {
                question: "对于旅行，你更倾向于？",
                options: [
                    "深度游，体验当地文化",
                    "休闲游，放松身心",
                    "网红打卡，拍照分享",
                    "探险游，挑战自我"
                ]
            },
            {
                question: "面对困难，你会？",
                options: [
                    "独立解决，展现能力",
                    "寻求帮助，团队合作",
                    "冷静分析，寻找方案",
                    "暂时放下，调整状态"
                ]
            },
            {
                question: "你认为幸福的核心是？",
                options: [
                    "事业成功，实现价值",
                    "家庭和睦，生活安稳",
                    "朋友在侧，有人分享",
                    "自由自在，随心所欲"
                ]
            }
        ];

        // 六维度映射
        const dimensionMapping = {
            0: 'money',      // 搞钱
            1: 'relax',      // 松弛
            2: 'open',       // 开放
            3: 'open',       // 开放
            0: 'money',      // 搞钱
            1: 'relax',      // 松弛
            4: 'environment', // 环境
            2: 'open',       // 开放
            1: 'relax',      // 松弛
            2: 'open',       // 开放
            2: 'open',       // 开放
            1: 'relax',      // 松弛
            2: 'open',       // 开放
            0: 'money',      // 搞钱
            5: 'stability'   // 安稳
        };

        let currentQuestion = 0;
        let userAnswers = [];
        let userScores = {
            money: 0,
            relax: 0,
            open: 0,
            food: 0,
            environment: 0,
            stability: 0
        };

        // 初始化问题
        function initQuiz() {
            const quizContainer = document.getElementById('quizContainer');
            quizContainer.innerHTML = '';
            
            questions.forEach((q, index) => {
                const questionCard = document.createElement('div');
                questionCard.className = 'question-card';
                questionCard.id = `question-${index}`;
                
                questionCard.innerHTML = `
                    <div class="question-number">问题 ${index + 1} / ${questions.length}</div>
                    <div class="question-text">${q.question}</div>
                    <div class="options">
                        ${q.options.map((opt, optIndex) => `
                            <div class="option" onclick="selectOption(${index}, ${optIndex})">
                                <div class="option-icon">${['A', 'B', 'C', 'D'][optIndex]}</div>
                                <div>${opt}</div>
                            </div>
                        `).join('')}
                    </div>
                `;
                
                quizContainer.appendChild(questionCard);
            });
            
            showQuestion(0);
        }

        // 显示问题
        function showQuestion(index) {
            const cards = document.querySelectorAll('.question-card');
            cards.forEach(card => card.classList.remove('active'));
            
            const currentCard = document.getElementById(`question-${index}`);
            if (currentCard) {
                currentCard.classList.add('active');
            }
            
            updateProgress();
        }

        // 更新进度条
        function updateProgress() {
            const progress = (currentQuestion / questions.length) * 100;
            document.getElementById('progressFill').style.width = `${progress}%`;
        }

        // 选择选项
        function selectOption(questionIndex, optionIndex) {
            const options = document.querySelectorAll(`#question-${questionIndex} .option`);
            options.forEach(opt => opt.classList.remove('selected'));
            options[optionIndex].classList.add('selected');
            
            // 计算分数（基于维度映射）
            const dimension = dimensionMapping[questionIndex];
            const scoreIncrement = [25, 15, 20, 30][optionIndex];
            userScores[dimension] += scoreIncrement;
            
            userAnswers[questionIndex] = optionIndex;
            
            setTimeout(() => {
                if (currentQuestion < questions.length - 1) {
                    currentQuestion++;
                    showQuestion(currentQuestion);
                } else {
                    showResult();
                }
            }, 500);
        }

        // 计算匹配度
        function calculateMatch(city) {
            const totalDiff = 
                Math.abs(city.dimensions.money - userScores.money) +
                Math.abs(city.dimensions.relax - userScores.relax) +
                Math.abs(city.dimensions.open - userScores.open) +
                Math.abs(city.dimensions.food - userScores.food) +
                Math.abs(city.dimensions.environment - userScores.environment) +
                Math.abs(city.dimensions.stability - userScores.stability);
            
            // 最大差异值：每个维度最大差值约为75，6个维度最大总差值为450
            const maxDiff = 450;
            const matchScore = Math.max(0, Math.min(100, Math.round((1 - totalDiff / maxDiff) * 100)));
            
            return matchScore;
        }

        // 显示结果
        function showResult() {
            document.getElementById('quizContainer').style.display = 'none';
            document.querySelector('.progress-bar').style.display = 'none';
            
            const resultCard = document.getElementById('resultCard');
            resultCard.classList.add('active');
            
            // 找到匹配度最高的城市
            let bestCity = cities[0];
            let bestScore = 0;
            
            const cityScores = cities.map(city => ({
                city,
                score: calculateMatch(city)
            }));
            
            cityScores.sort((a, b) => b.score - a.score);
            
            bestCity = cityScores[0].city;
            bestScore = cityScores[0].score;
            
            // 显示主要结果
            document.getElementById('cityName').textContent = bestCity.name;
            document.getElementById('matchScore').textContent = bestScore;
            
            // 显示标签
            const tagsContainer = document.getElementById('cityTags');
            tagsContainer.innerHTML = bestCity.tags.map(tag => `<div class="tag">${tag}</div>`).join('');
            
            // 显示描述
            document.getElementById('cityDescription').textContent = bestCity.description;
            
            // 绘制雷达图
            drawRadarChart(bestCity);
            
            // 显示同类城市推荐（前4个，不包括最佳匹配）
            const cityList = document.getElementById('cityList');
            const similarCities = cityScores.slice(1, 5);
            cityList.innerHTML = similarCities.map(item => `
                <div class="city-item">
                    <div class="city-item-name">${item.city.name}</div>
                    <div class="city-item-score">${item.score}%</div>
                </div>
            `).join('');
        }

        // 绘制雷达图
        function drawRadarChart(city) {
            const canvas = document.getElementById('radarChart');
            const ctx = canvas.getContext('2d');
            
            // 设置画布大小
            canvas.width = 400;
            canvas.height = 400;
            
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = 150;
            
            const dimensions = [
                { name: '搞钱', value: city.dimensions.money },
                { name: '松弛', value: city.dimensions.relax },
                { name: '开放', value: city.dimensions.open },
                { name: '美食', value: city.dimensions.food },
                { name: '环境', value: city.dimensions.environment },
                { name: '安稳', value: city.dimensions.stability }
            ];
            
            const angleStep = (Math.PI * 2) / dimensions.length;
            
            // 绘制背景网格
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 1;
            
            for (let i = 5; i > 0; i--) {
                const levelRadius = (radius / 5) * i;
                ctx.beginPath();
                for (let j = 0; j <= dimensions.length; j++) {
                    const angle = j * angleStep - Math.PI / 2;
                    const x = centerX + Math.cos(angle) * levelRadius;
                    const y = centerY + Math.sin(angle) * levelRadius;
                    
                    if (j === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                }
                ctx.closePath();
                ctx.stroke();
            }
            
            // 绘制轴线
            ctx.strokeStyle = '#e0e0e0';
            for (let i = 0; i < dimensions.length; i++) {
                const angle = i * angleStep - Math.PI / 2;
                const x = centerX + Math.cos(angle) * radius;
                const y = centerY + Math.sin(angle) * radius;
                
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.lineTo(x, y);
                ctx.stroke();
                
                // 绘制标签
                const labelX = centerX + Math.cos(angle) * (radius + 30);
                const labelY = centerY + Math.sin(angle) * (radius + 30);
                
                ctx.font = '14px Arial';
                ctx.fillStyle = '#333';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(dimensions[i].name, labelX, labelY);
            }
            
            // 绘制数据区域
            ctx.beginPath();
            for (let i = 0; i <= dimensions.length; i++) {
                const index = i % dimensions.length;
                const angle = index * angleStep - Math.PI / 2;
                const value = dimensions[index].value / 100;
                const x = centerX + Math.cos(angle) * (radius * value);
                const y = centerY + Math.sin(angle) * (radius * value);
                
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            ctx.closePath();
            
            // 填充渐变色
            const gradient = ctx.createRadialGradient(centerX, centerY, 0, centerX, centerY, radius);
            gradient.addColorStop(0, 'rgba(102, 126, 234, 0.5)');
            gradient.addColorStop(1, 'rgba(118, 75, 162, 0.5)');
            ctx.fillStyle = gradient;
            ctx.fill();
            
            // 绘制边框
            ctx.strokeStyle = '#667eea';
            ctx.lineWidth = 3;
            ctx.stroke();
        }

        // 重新测试
        function restartQuiz() {
            currentQuestion = 0;
            userAnswers = [];
            userScores = {
                money: 0,
                relax: 0,
                open: 0,
                food: 0,
                environment: 0,
                stability: 0
            };
            
            document.getElementById('resultCard').classList.remove('active');
            document.getElementById('quizContainer').style.display = 'block';
            document.querySelector('.progress-bar').style.display = 'block';
            
            initQuiz();
        }

        // 启动测试
        initQuiz();
    </script>
</body>
</html>
